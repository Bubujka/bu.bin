#!/bin/bash
if [ "$#" -eq 0 ]; then
      echo "Нужно указать имя файла +_+"
      exit
fi

echo -n "Битрэйт (600k): "
read bitrate
if [ "$bitrate" == "" ]; then
  bitrate='600'
fi

echo -n "размер (1280x720): "
read size
if [ "$size" == "" ]; then
  size='1280x720'
fi

DIR="${bitrate}k_${size}"
mkdir -p "$DIR" 2> /dev/null
options="-y -s $size -b ${bitrate}k -acodec libvorbis -ab 160000 -g 30"

for file in "$@"
do
  avconv -i "${file}" -an $options -vcodec libx264   -preset slow "${DIR}/${file}.mp4"
  avconv -i "${file}" -an $options -vcodec libvpx    -f webm      "${DIR}/${file}.webm"
  avconv -i "${file}" -an $options -vcodec libtheora              "${DIR}/${file}.ogv"
done
